require 'spec_helper'
require 'ronin/post_exploitation/mixin'

describe PostExploitation::Mixin do
  subject do
    obj = Object.new
    obj.extend PostExploitation::Mixin
    obj
  end

  it "should lazily initialize controlled resources objects" do
    subject.resources.should be_empty
    subject.resources[:shell].should_not be_nil
  end

  it "should not provide access to other resources" do
    subject.resources[:foo].should be_nil
  end

  it "should define methods for accessing the resources" do
    subject.should respond_to(:fs)
  end
end
